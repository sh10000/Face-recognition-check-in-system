<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">`
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>登录界面</title>
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">
    <script src="../static/js/jquery-1.11.3.min.js"></script>
    <script src="../static/js/bootstrap.min.js"></script>
</head>
<body>
	<div class="container">
  		<!-- 网站头部 -->
		    <div class="row">
		   	 	<div class="col-xs-12" style="border: 2px soid blueviolet;">
		   	 		<h1>欢迎来到XX在线学习平台</h1>
		   	 	</div>
		   	</div> 

		   	 
		   	<!--  导航条 -->
		   	<nav class="navbar navbar-inverse">
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
				    <ul class="nav navbar-nav">
				      	<li><a href="test-studentdis.htm">学生签到窗口(当前)</a></li>
						<li><a href="/login">登录</a></li>
						<li><a href="#">欢迎用户：{{stuName}}</a></li>
						<li><a href=/logout>退出登录</a></li>
				    </ul>

				    <form class="navbar-form navbar-right" role="search">
				        <div class="form-group">
				          <input type="text" class="form-control" placeholder="Search">
				        </div>
				        <button type="submit" class="btn btn-default">Submit</button>
				    </form>
				 </div>
				 
			</nav>


		   	<!-- 注册页面主体-->
		   	<div class="row" style="height: 300px;">
		   	 	<div class="container">
					<div>
					  	<video id="video"></video>
					  	<h3 class="txt1">识别中，请保持合适距离<br>将面部置于画面中央</h3>
					  	<canvas id="canvas" style="display: none">
					  	<script>
					      const width = 480;
					      const height = 320;
					      const video = document.getElementById('video');
					 
					      //访问摄像头
					      if (navigator.mediaDevices.getUserMedia || navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia) {
					          //调用用户媒体设备, 访问摄像头
					          getUserMedia({video: {width: width, height: height}}, success, error);
					      } else {
					          alert('不支持访问用户媒体');
					      }
					 
					      //访问用户媒体设备的兼容方法
					      function getUserMedia(constraints, success, error) {
					          if (navigator.mediaDevices.getUserMedia) {
					              //最新的标准API
					              navigator.mediaDevices.getUserMedia(constraints).then(success).catch(error);
					          } else if (navigator.webkitGetUserMedia) {
					              //webkit核心浏览器
					              navigator.webkitGetUserMedia(constraints, success, error)
					          } else if (navigator.mozGetUserMedia) {
					              //firfox浏览器
					              navigator.mozGetUserMedia(constraints, success, error);
					          } else if (navigator.getUserMedia) {
					              //旧版API
					              navigator.getUserMedia(constraints, success, error);
					          }
					      }
					 
					      //成功回调
					      function success(stream) {
					          console.log('成功');
					          //兼容webkit核心浏览器
					          // const CompatibleURL = window.URL || window.webkitURL;
					          //将视频流设置为video元素的源
					          // video.src = CompatibleURL.createObjectURL(stream);
					          video.srcObject = stream;
					          video.play();
					          setInterval(drawCanvasImage, 10)
					      }
					 
					      //失败回调
					      function error(error) {
					          console.log('失败');
					          console.log("访问用户媒体设备失败", error);
					      }
					 
					      function drawCanvasImage() {
					          const canvas = document.getElementById('canvas');
					          canvas.width = width;
					          canvas.height = height;
					          const context = canvas.getContext('2d');
					          context.drawImage(video, 0, 0, width, height, 0, 0, width, height);
					          //获取图片，数据格式为base64
					          const imageData = canvas.toDataURL("image/png");
					          console.log(imageData)
					      }
					  	</script>
						</div>
					</div>
		   		</div>
		   	</div>    
		    <!-- 网站底部 -->
		   	
		   	<div class="row">
		   	 	<div class="col-xs-12 text-center">
		   	 		<ul class="list-inline">
		   	 			<li><a href="">校园官网</a></li>
		   	 			<li><a href="">帮助手册</a></li>
		   	 			<li><a href="">信息化办公室</a></li>
		   	 		</ul>
		   	 	</div>
		   	</div>
		   	<div class="row">
		   	 	<div class="col-xs-12 text-center">
		   	 		Copyright © XXX版权所有 
		   	 	</div>
		   	</div>
	</div>
</body>
</html>
